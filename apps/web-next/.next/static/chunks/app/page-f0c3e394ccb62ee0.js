(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3299:function(e,t,n){Promise.resolve().then(n.bind(n,6117))},6117:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var s=n(7437),a=n(9903),l=n(5389);function i(){let{user:e}=(0,l.a)();return e?(0,s.jsxs)("main",{className:"mx-auto max-w-3xl px-4 py-8",children:[(0,s.jsx)("h1",{className:"text-2xl font-semibold",children:"Welcome"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-zinc-400",children:"You are signed in."}),(0,s.jsx)("div",{className:"mt-6",children:(0,s.jsx)(a.Z,{})})]}):(0,s.jsxs)("main",{className:"mx-auto max-w-3xl px-4 py-8",children:[(0,s.jsx)("h1",{className:"text-2xl font-semibold",children:"Submit a confession"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-zinc-400",children:"You are not signed in."}),(0,s.jsx)("div",{className:"mt-6",children:(0,s.jsx)(a.Z,{})})]})}},9903:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var s=n(7437),a=n(2265),l=n(5389);let i="http://127.0.0.1:8000";function r(){let{user:e}=(0,l.a)(),[t,n]=(0,a.useState)("female"),[r,c]=(0,a.useState)(21),[o,d]=(0,a.useState)(""),[u,m]=(0,a.useState)(!0),[x,h]=(0,a.useState)(!1),[p,f]=(0,a.useState)(null),[b,g]=(0,a.useState)(null),[j,v]=(0,a.useState)(!1),[N,y]=(0,a.useState)(null);async function S(){h(!0),g(null),f(null);try{let e=await fetch("".concat(i,"/confessions"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({gender:t,age:Number(r),content:o,anonymous:u,language:"en"})});if(!e.ok)throw Error("Failed: ".concat(e.status));let n=await e.json();f(n)}catch(t){var e;g(null!==(e=null==t?void 0:t.message)&&void 0!==e?e:"Submit failed")}finally{h(!1)}}async function w(e){if(p){v(!0),g(null),y(null);try{let t=await fetch("".concat(i,"/publish/").concat(p.id),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({platforms:e})});if(!t.ok)throw Error("Publish failed: ".concat(t.status));let n=await t.json();y(n)}catch(e){var t;g(null!==(t=null==e?void 0:e.message)&&void 0!==t?t:"Publish failed")}finally{v(!1)}}}return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-4 rounded-lg border border-zinc-800 p-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm text-zinc-400",children:"Gender"}),(0,s.jsxs)("select",{className:"mt-1 w-full rounded-md border border-zinc-800 bg-zinc-900 px-3 py-2 text-sm text-zinc-100 focus:outline-none focus:ring-2 focus:ring-brand/40",value:t,onChange:e=>n(e.target.value),children:[(0,s.jsx)("option",{value:"female",children:"Female"}),(0,s.jsx)("option",{value:"male",children:"Male"}),(0,s.jsx)("option",{value:"non-binary",children:"Non-binary"}),(0,s.jsx)("option",{value:"trans-woman",children:"Transgender woman"}),(0,s.jsx)("option",{value:"trans-man",children:"Transgender man"}),(0,s.jsx)("option",{value:"genderqueer",children:"Genderqueer"}),(0,s.jsx)("option",{value:"genderfluid",children:"Genderfluid"}),(0,s.jsx)("option",{value:"agender",children:"Agender"}),(0,s.jsx)("option",{value:"prefer-not-to-say",children:"Prefer not to say"}),(0,s.jsx)("option",{value:"other",children:"Other"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm text-zinc-400",children:"Age"}),(0,s.jsx)("input",{type:"number",className:"mt-1 w-full rounded-md border border-zinc-800 bg-zinc-900 px-3 py-2 text-sm text-zinc-100 focus:outline-none focus:ring-2 focus:ring-brand/40",value:r,onChange:e=>c(Number(e.target.value)),min:13,max:120})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm text-zinc-400",children:"Content"}),(0,s.jsx)("textarea",{rows:10,className:"mt-1 w-full rounded-md border border-zinc-800 bg-zinc-900 px-3 py-2 text-sm text-zinc-100 focus:outline-none focus:ring-2 focus:ring-brand/40",value:o,onChange:e=>d(e.target.value),placeholder:"Write your confession..."})]}),(0,s.jsxs)("label",{className:"flex items-center gap-2 text-sm text-zinc-300",children:[(0,s.jsx)("input",{type:"checkbox",className:"h-4 w-4 rounded border-zinc-700 bg-zinc-900",checked:u,onChange:e=>m(e.currentTarget.checked)}),"Post anonymously"]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("button",{onClick:S,disabled:x||!o.trim(),className:"rounded-md bg-brand px-4 py-2 text-sm font-medium text-white disabled:opacity-50",children:x?"Submitting...":"Submit"}),b&&(0,s.jsx)("span",{className:"text-sm text-red-400",children:b})]})]}),p&&(0,s.jsxs)("div",{className:"rounded-lg border border-zinc-800 p-4",children:[(0,s.jsxs)("div",{className:"text-sm text-zinc-400",children:["Created #",p.id," â€¢ status"," ",(0,s.jsx)("span",{className:"approved"===p.status?"text-green-400":"blocked"===p.status?"text-red-400":"text-yellow-400",children:p.status})]}),(0,s.jsx)("p",{className:"mt-2 whitespace-pre-wrap",children:p.content}),e&&(0,s.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>w(["fb","ig"]),disabled:j||"approved"!==p.status,className:"rounded-md bg-brand px-3 py-2 text-sm text-white disabled:opacity-50",children:j?"Queuing...":"Publish to FB/IG"}),(0,s.jsx)("button",{onClick:()=>w(["x"]),disabled:j||"approved"!==p.status,className:"rounded-md bg-zinc-800 px-3 py-2 text-sm text-zinc-100 hover:bg-zinc-700 disabled:opacity-50",children:j?"Queuing...":"Publish to X"})]}),N&&e&&(0,s.jsxs)("p",{className:"mt-2 text-sm text-zinc-400",children:["Publish job queued: id ",N.id,". Check Jobs page."]})]})]})}},5389:function(e,t,n){"use strict";n.d(t,{H:function(){return r},a:function(){return c}});var s=n(7437),a=n(2265);let l=(0,a.createContext)(void 0),i="auth:user";function r(e){let{children:t}=e,[n,r]=(0,a.useState)(null);(0,a.useEffect)(()=>{try{let e=localStorage.getItem(i);e&&r(JSON.parse(e))}catch(e){}},[]);let c=async(e,t)=>{let n=localStorage.getItem(i);if(n){r(JSON.parse(n));return}let s={email:e,role:"user"};localStorage.setItem(i,JSON.stringify(s)),r(s)},o=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s={email:e,role:n?"admin":"user"};localStorage.setItem(i,JSON.stringify(s)),r(s)},d=()=>{localStorage.removeItem(i),r(null)},u=(0,a.useMemo)(()=>({user:n,signIn:c,signUp:o,signOut:d}),[n]);return(0,s.jsx)(l.Provider,{value:u,children:t})}function c(){let e=(0,a.useContext)(l);if(!e)throw Error("useAuth must be used within AuthProvider");return e}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=3299)}),_N_E=e.O()}]);