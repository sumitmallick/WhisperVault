(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[411],{4579:function(e,t,s){Promise.resolve().then(s.bind(s,1880))},1880:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return l}});var n=s(7437),r=s(2265),a=s(4716),c=s(5389);let i="http://127.0.0.1:8000";function l(){let{user:e}=(0,c.a)(),[t,s]=(0,r.useState)([]),[l,o]=(0,r.useState)(!1),[d,u]=(0,r.useState)(""),[x,m]=(0,r.useState)(null),[f,h]=(0,r.useState)(null),b=!!e&&"admin"===e.role;async function j(){o(!0),h(null);try{let e=await fetch("".concat(i,"/publish/jobs?limit=20"),{cache:"no-store"});if(!e.ok)throw Error("List failed: ".concat(e.status));let t=await e.json();s(t)}catch(t){var e;h(null!==(e=t.message)&&void 0!==e?e:"Failed to load jobs")}finally{o(!1)}}async function v(){if(d.trim()){o(!0),h(null),m(null);try{let e=await fetch("".concat(i,"/publish/jobs/").concat(d),{cache:"no-store"});if(!e.ok)throw Error("Fetch failed: ".concat(e.status));let t=await e.json();m(t)}catch(t){var e;h(null!==(e=t.message)&&void 0!==e?e:"Failed to fetch job")}finally{o(!1)}}}return((0,r.useEffect)(()=>{b&&j()},[b]),b)?(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsx)("h1",{className:"text-2xl font-semibold",children:"Publish jobs"}),(0,n.jsxs)("div",{className:"rounded-lg border border-zinc-800 p-4 space-y-3",children:[(0,n.jsx)("div",{className:"text-sm text-zinc-400",children:"Lookup a job by ID"}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(a.II,{placeholder:"Job ID",value:d,onChange:e=>u(e.target.value)}),(0,n.jsx)(a.zx,{onClick:v,disabled:l||!d.trim(),children:l?"Loading...":"Fetch"})]}),f&&(0,n.jsx)("div",{className:"text-sm text-red-400",children:f}),x&&(0,n.jsxs)("div",{className:"rounded-md border border-zinc-800 p-3",children:[(0,n.jsxs)("div",{className:"text-sm text-zinc-400",children:["Job #",x.id]}),(0,n.jsxs)("div",{className:"text-sm",children:["Confession: ",x.confession_id]}),(0,n.jsxs)("div",{className:"text-sm",children:["Platforms: ",x.platforms_csv]}),(0,n.jsxs)("div",{className:"text-sm",children:["Status:"," ",(0,n.jsx)("span",{className:"completed"===x.status?"text-green-400":"failed"===x.status?"text-red-400":"text-yellow-400",children:x.status})]}),x.asset_path&&(0,n.jsxs)("div",{className:"text-sm truncate",children:["Image: ",x.asset_path]}),x.error&&(0,n.jsxs)("div",{className:"text-sm text-red-400",children:["Error: ",x.error]})]})]}),(0,n.jsxs)("div",{className:"rounded-lg border border-zinc-800 p-4 space-y-3",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("div",{className:"text-sm text-zinc-400",children:"Recent jobs"}),(0,n.jsx)(a.zx,{className:"bg-zinc-800 text-zinc-100 hover:bg-zinc-700",onClick:j,disabled:l,children:"Refresh"})]}),(0,n.jsxs)("div",{className:"space-y-3",children:[0===t.length&&(0,n.jsx)("div",{className:"text-sm text-zinc-400",children:"No jobs yet."}),t.map(e=>(0,n.jsxs)("div",{className:"rounded-md border border-zinc-800 p-3",children:[(0,n.jsxs)("div",{className:"text-sm text-zinc-400",children:["Job #",e.id]}),(0,n.jsxs)("div",{className:"text-sm",children:["Confession: ",e.confession_id]}),(0,n.jsxs)("div",{className:"text-sm",children:["Platforms: ",e.platforms_csv]}),(0,n.jsxs)("div",{className:"text-sm",children:["Status:"," ",(0,n.jsx)("span",{className:"completed"===e.status?"text-green-400":"failed"===e.status?"text-red-400":"text-yellow-400",children:e.status})]}),e.asset_path&&(0,n.jsxs)("div",{className:"text-sm truncate",children:["Image: ",e.asset_path]}),e.error&&(0,n.jsxs)("div",{className:"text-sm text-red-400",children:["Error: ",e.error]})]},e.id))]})]})]}):(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("h1",{className:"text-2xl font-semibold",children:"Publish jobs"}),(0,n.jsx)("p",{className:"text-sm text-zinc-400",children:"You don't have access to this page."})]})}},4716:function(e,t,s){"use strict";s.d(t,{II:function(){return c},XZ:function(){return i},zx:function(){return a}});var n=s(7437);s(2265);var r=s(1994);function a(e){let{className:t,...s}=e;return(0,n.jsx)("button",{className:(0,r.W)("inline-flex items-center justify-center rounded-md bg-brand px-3 py-2 text-sm font-medium text-black","hover:bg-brand-dark focus:outline-none focus:ring-2 focus:ring-brand/50 disabled:opacity-50",t),...s})}function c(e){let{className:t,...s}=e;return(0,n.jsx)("input",{className:(0,r.W)("w-full rounded-md border border-zinc-800 bg-zinc-900 px-3 py-2 text-sm text-zinc-100","placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-brand/40",t),...s})}function i(e){let{className:t,...s}=e;return(0,n.jsx)("input",{type:"checkbox",className:(0,r.W)("h-4 w-4 accent-brand",t),...s})}},5389:function(e,t,s){"use strict";s.d(t,{H:function(){return i},a:function(){return l}});var n=s(7437),r=s(2265);let a=(0,r.createContext)(void 0),c="auth:user";function i(e){let{children:t}=e,[s,i]=(0,r.useState)(null);(0,r.useEffect)(()=>{try{let e=localStorage.getItem(c);e&&i(JSON.parse(e))}catch(e){}},[]);let l=async(e,t)=>{let s=localStorage.getItem(c);if(s){i(JSON.parse(s));return}let n={email:e,role:"user"};localStorage.setItem(c,JSON.stringify(n)),i(n)},o=async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n={email:e,role:s?"admin":"user"};localStorage.setItem(c,JSON.stringify(n)),i(n)},d=()=>{localStorage.removeItem(c),i(null)},u=(0,r.useMemo)(()=>({user:s,signIn:l,signUp:o,signOut:d}),[s]);return(0,n.jsx)(a.Provider,{value:u,children:t})}function l(){let e=(0,r.useContext)(a);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},1994:function(e,t,s){"use strict";function n(){for(var e,t,s=0,n="",r=arguments.length;s<r;s++)(e=arguments[s])&&(t=function e(t){var s,n,r="";if("string"==typeof t||"number"==typeof t)r+=t;else if("object"==typeof t){if(Array.isArray(t)){var a=t.length;for(s=0;s<a;s++)t[s]&&(n=e(t[s]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n)}return r}(e))&&(n&&(n+=" "),n+=t);return n}s.d(t,{W:function(){return n}})}},function(e){e.O(0,[971,117,744],function(){return e(e.s=4579)}),_N_E=e.O()}]);